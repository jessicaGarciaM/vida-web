document.addEventListener('DOMContentLoaded', function () {

    /* ========================================= */
    /* 1. FUNCIONALIDAD DEL CARRUSEL PRINCIPAL (HERO) */
    /* ========================================= */
    const slides = document.querySelectorAll('.slide-image');
    let currentSlide = 0;

    function showSlide(index) {
        // Oculta todas las diapositivas con baja opacidad
        slides.forEach((slide, i) => {
            slide.style.opacity = '0';
            slide.style.zIndex = '1';
        });

        // Muestra la diapositiva actual y la pone al frente
        slides[index].style.opacity = '1';
        slides[index].style.zIndex = '5';
        currentSlide = index;
    }

    function nextSlide() {
        let newIndex = (currentSlide + 1) % slides.length;
        showSlide(newIndex);
    }

    // Inicializar el carrusel y establecer el temporizador
    if (slides.length > 0) {
        showSlide(0);
        setInterval(nextSlide, 5000);
    }


    /* ========================================= */
    /* 2. FUNCIONALIDAD DEL MENÚ MÓVIL */
    /* ========================================= */
    const menuToggle = document.getElementById('menu-toggle');
    const nav = document.querySelector('.nav');

    menuToggle.addEventListener('click', () => {
        nav.classList.toggle('active');

        // Si el menú principal se cierra, cerrar todos los submenús
        if (!nav.classList.contains('active')) {
            document.querySelectorAll('.dropdown.active').forEach(item => {
                item.classList.remove('active');
            });
        }
    });

    // Cerrar el menú si se hace clic en un enlace (móvil)
    document.querySelectorAll('.nav a').forEach(link => {
        link.addEventListener('click', () => {
            // Se asegura de cerrar el menú principal solo si es un enlace de navegación normal
            if (!link.classList.contains('dropdown-toggle')) {
                nav.classList.remove('active');
                // Cierra también los submenús al navegar
                document.querySelectorAll('.dropdown.active').forEach(item => {
                    item.classList.remove('active');
                });
            }
        });
    });


    /* ========================================= */
    /* 3. FUNCIONALIDAD DEL SUBMENÚ (DROPDOWN) */
    /* ========================================= */
    const dropdownToggles = document.querySelectorAll('.dropdown-toggle');

    dropdownToggles.forEach(toggle => {
        toggle.addEventListener('click', function (e) {
            // Solo para pantallas pequeñas (móvil)
            if (window.innerWidth <= 992) {
                e.preventDefault(); // Detener la navegación para que se abra el menú
                const parentDropdown = this.closest('.dropdown');

                // Cerrar otros submenús si están abiertos
                document.querySelectorAll('.dropdown').forEach(item => {
                    if (item !== parentDropdown) {
                        item.classList.remove('active');
                    }
                });

                // Abrir o cerrar el submenú actual
                parentDropdown.classList.toggle('active');
            }
        });
    });


    /* ========================================= */
    /* 4. SLIDERS DE FOTOS (Galería) */
    /* ========================================= */
    function setupSlider(sliderId) {
        const slider = document.querySelector(`.slider-track[data-slider="${sliderId}"]`);
        if (!slider) return;

        const slides = slider.querySelectorAll('.slider-slide');
        let currentIndex = 0;

        function updateSlider() {
            const slideWidth = slides[0].clientWidth;
            slider.style.transform = `translateX(-${currentIndex * slideWidth}px)`;
        }

        function nextSlidePhotos() {
            currentIndex = (currentIndex + 1) % slides.length;
            updateSlider();
        }

        function prevSlidePhotos() {
            currentIndex = (currentIndex - 1 + slides.length) % slides.length;
            updateSlider();
        }

        // Eventos para botones
        document.querySelector(`.slider-btn.next[data-slider-target="${sliderId}"]`).addEventListener('click', nextSlidePhotos);
        document.querySelector(`.slider-btn.prev[data-slider-target="${sliderId}"]`).addEventListener('click', prevSlidePhotos);

        // Actualizar el slider si la ventana cambia de tamaño
        window.addEventListener('resize', updateSlider);

        // Auto-avance (opcional, pero mantiene la galería viva)
        setInterval(nextSlidePhotos, 4000); // Cambia cada 4 segundos
    }

    // Inicializar los 3 sliders de fotos
    setupSlider(1);
    setupSlider(2);
    setupSlider(3);


    /* ========================================= */
    /* 5. FUNCIONALIDAD DE MODALES (GLOBAL) */
    /* ========================================= */

    // NOTA: Estas funciones son las que usas en el HTML con onclick="openModal('ID_DEL_MODAL')".
    // Funcionan para abrir cualquier modal de la página.
    // (Funciones openModal y closeModal se mantienen fuera del DOMContentLoaded)


}); // FIN de DOMContentLoaded


/* ========================================= */
/* FUNCIONALIDAD DE MODALES (GLOBAL) */
/* ========================================= */

function openModal(modalId) {
    const modal = document.getElementById(modalId);
    if (modal) {
        modal.style.display = 'block';
    }
}

function closeModal(modalId) {
    const modal = document.getElementById(modalId);
    if (modal) {
        modal.style.display = 'none';
    }
}

// Cerrar el modal haciendo clic fuera del contenido
window.onclick = function (event) {
    if (event.target.classList.contains('modal')) {
        event.target.style.display = "none";
    }
}
